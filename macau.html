<!DOCTYPE html>
<html>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<body>

<H2>Macau</H2>

Computer Cards:
<div id="cpucards"> </div>
<br>
Your Cards:
<div id="playercards"> </div>
<br>
<input type="button" value="Draw Card!" onclick="draw(player,1)">
<br>
<br>
Pile:
<div id="currentpile"> </div>
<br>
Remaining Cards:
<div id="unused"> </div>



<script>

let deck = shuffle(getDeck());
let player = [];
let cpu = [];
let pile = []

//initialize deck
function getDeck() {
let suits = ["♠", "♦", "♣", "♥"];
let values = ["A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];

	let playdeck = new Array();

for(let i = 0; i < suits.length; i++)
	{
		for(let x = 0; x < values.length; x++)
		{
			let card = {v: values[x], c: suits[i]};
		playdeck.push(card);
		}
	}
	return playdeck;
};

// shuffle array
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}

//drawcard function
function draw(x,j){
  for (var i = 0; i < j; i++) {
    let temp = deck.shift();
    x.push(temp);
  }
  redraw();
};

function displaycards(where,what) {
  let temp = '';
  let number = 0;
  for (var card of what) {
    temp = card.c + "" + card.v;
    let para = document.createElement("span");
    let t = document.createTextNode(temp);
    para.dataset.cardc = card.c;
    para.dataset.cardv = card.v;
    para.dataset.cardo = where.id;
    para.dataset.cardn = number;
    number++;
    if (card.c == "♥" || card.c == "♦") {
      para.style = "color:red; border: 1px solid black; padding:3px; margin:1px";
    } else {
      para.style = "color:black; border: 1px solid black; padding:3px; margin:1px";
    };
    // see remaining deck
    if (where == unused) {
       para.style = "color:white; border: 1px solid black; padding:3px; margin:1px";
    }

    para.appendChild(t);
    if (where == playercards ) {
      para.addEventListener("click", playcard);
    };
    document.getElementById(where.id).appendChild(para);
  }
};

function start(){
  draw(pile, 1);
};

function playcard(x){
  let cardc = x.currentTarget.dataset.cardc;
  let cardv = x.currentTarget.dataset.cardv;
  let owner = x.currentTarget.dataset.cardo;
  let num = x.currentTarget.dataset.cardn;
  let val = pile[0].v;
  let col = pile[0].c;

  if (cardc == col || cardv == val ) {
    if (owner = 'playercards') {
      pile.push(player[num]);
      player.splice(num,1);
  } else if (owner == cpucards ) {
      pile.push(cpu[num]);
      cpu.splice(num,1);
  }

  }

redraw();
};

function clear(){
  removeAllChildNodes(cpucards);
  removeAllChildNodes(playercards);
  removeAllChildNodes(currentpile);
  removeAllChildNodes(unused);
};

function removeAllChildNodes(parent) {
    while (parent.firstChild) {
        parent.removeChild(parent.firstChild);
    }
};


function redraw() {
  clear();
  displaycards(cpucards, cpu);
  displaycards(playercards, player);
  displaycards(currentpile,pile);
  displaycards(unused,deck);
};

draw(player, 5);
draw(cpu, 5);
start();
redraw();

</script>

</body>
</html>
